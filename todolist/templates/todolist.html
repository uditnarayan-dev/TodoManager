{% extends "base.html" %}

{% block title %}
Todo List
{% endblock title %}

{% block headline %}
Todo List
{% endblock headline %}

{% block content %}

<div class='container'>
  {% if messages %}
  {% for message in messages  %}
    <div class="alert alert-warning alert-dismissible fade show" role="alert">
      {{message}}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
  {% endif %}
  <br>

  <form method="POST">
    {% csrf_token %}
    <div class="mb-3">
      <input type="text" class="form-control" name="task" placeholder="New Task">
    </div>
    <button type="submit" class="btn btn-primary">Add Task</button>
  </form>

  <br>

  <h5 class="mb-3">
    Page {{all_tasks.number}} of {{all_tasks.paginator.num_pages}} 
  </h5>

  <table class="table table-bordered">
    <thead class="table-dark">
      <tr class="row">
        <th class="col-1" scope="col">S.No.</th>
        <th class="col-5" scope="col">Task</th>
        <th class="col-3" scope="col">Status</th>
        <th class="col-2" scope="col">Edit</th>
        <th class="col-1" scope="col">Delete</th>
      </tr>
    </thead>
    {% for task in all_tasks %}
    <tbody>
      {% if task.is_completed %}
      <tr class="table-success row">
        <th class="col-1" scope="row">{{forloop.counter}}</th>
        <td class="col-5">{{task.task}} </td>
        <td class="col-3"><a href="{% url 'pending_task' task.id %}"><button type="button" class="btn btn-success">Mark - Pending</button></a></td>
        <td class="col-2"><a href="{% url 'edit_task' task.id %}"><button type="button" class="btn btn-warning">Edit</button></a></td>
        <td class="col-1"> <a href="{% url 'delete_task' task.id %}"><button type="button" class="btn btn-danger">Delete</button></a> </td>
      </tr>
      {% else %}
      <tr class="row">
        <th class="col-1" scope="row">{{forloop.counter}}</th>
        <td class="col-5">{{task.task}} </td>
        <td class="col-3"><a href="{% url 'complete_task' task.id %}"><button type="button" class="btn btn-secondary">Mark - Completed</button></a></td>
        <td class="col-2"><a href="{% url 'edit_task' task.id %}"><button type="button" class="btn btn-warning">Edit</button></a></td>
        <td class="col-1"> <a href="{% url 'delete_task' task.id %}"><button type="button" class="btn btn-danger">Delete</button></a> </td>
      </tr>
    </tbody>
    {% endif %}
    {% endfor %}
  </table>


  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-end">
      
      {% if all_tasks.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{ all_tasks.previous_page_number }}">«</a>
        </li>
      {% endif %}

      {% for num in all_tasks.paginator.page_range %}
        {% if num == all_tasks.number %}
          <li class="page-item active">
            <a class="page-link" href="?page={{ num }}">{{ num }}</a>
          </li>
        {% else %}
          <li class="page-item">
            <a class="page-link" href="?page={{ num }}">{{ num }}</a>
          </li>
        {% endif %}
      {% endfor %}

      {% if all_tasks.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ all_tasks.next_page_number }}">»</a>
        </li>
      {% endif %}

    </ul>
  </nav>


</div>

{% endblock content %}